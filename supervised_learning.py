#!/usr/bin/env python
# coding: utf-8

# <font color='blue' size=5><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>
# 
# <font color='blue'>–ü—Ä–∏–≤–µ—Ç, –ú–∞—Ä–∏—è! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ü–∞–≤–µ–ª –ì—Ä–∏–≥–æ—Ä—å–µ–≤, –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç.<br>–ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å - –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —Ç–æ–±–æ–π –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—É.<br>–°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É! –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª.</font>
# <details>
# 	<summary><u>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–º –º–æ–º–µ–Ω—Ç–∞–º (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ)</u>‚§µ</summary>
# <font color='blue'>–Ø –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ü–≤–µ—Ç–∞, —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</font>
# 
# 
# ---
# 
# 
# <font color='blue'>—Å–∏–Ω–∏–π —Ç–µ–∫—Å—Ç - –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è</font>
# 
# <font color='green'>‚úîÔ∏è –∏ –∑–µ–ª–µ–Ω—ã–π —Ç–µ–∫—Å—Ç - –≤—Å–µ –æ—Ç–ª–∏—á–Ω–æ</font>
# 
# <font color='orange'>‚ö†Ô∏è –∏ –æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ç–µ–∫—Å—Ç - —Å–¥–µ–ª–∞–Ω–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –æ–¥–Ω–∞–∫–æ –µ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –Ω–∞ —á—Ç–æ —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ</font>
# 
# <font color='red'>‚ùå –∏ –∫—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç - –µ—Å—Ç—å –Ω–µ–¥–æ—á–µ—Ç—ã</font>
# 
# 
# </details>    
#     </br>
# <font color='blue'>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–∞–±–æ—Ç—ã, —Ç–∞–∫ –±—É–¥–µ—Ç –ø—Ä–æ—â–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, –∫–∞–∫–∏–µ –±—ã–ª–∏ –Ω–µ–¥–æ—á–µ—Ç—ã, –∞ —Ç–∞–∫–∂–µ —Å—Ä–∞–∑—É —É–≤–∏–¥–µ—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ. </font>
# 
# –û—Ç–≤–µ—Ç—ã –Ω–∞ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ª—É—á—à–µ —Ç–æ–∂–µ –ø–æ–º–µ—á–∞—Ç—å.
# –ù–∞–ø—Ä–∏–º–µ—Ä: <font color='purple'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b></font>
# 
# <font color='blue'><b>–î–∞–≤–∞–π —Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å!</b></font>

# <font color='blue' size=3><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2</b></font>
# 
# <font color='blue'>–ü—Ä–∏–≤–µ—Ç –µ—â–µ —Ä–∞–∑. –°–ø–∞—Å–∏–±–æ, –∑–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ —Ä–∞–±–æ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –¢–æ–ª—å–∫–æ –æ–±–æ–∑–Ω–∞—á–∏–º, —á—Ç–æ —ç—Ç–æ –≤—Ç–æ—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è.</font>

# <font color='blue' size=3><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3</b></font>
# 
# <font color='blue'>–ü—Ä–∏–≤–µ—Ç –µ—â–µ —Ä–∞–∑. –°–ø–∞—Å–∏–±–æ, –∑–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ —Ä–∞–±–æ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.</font>

# # –û–±—É—á–µ–Ω–∏–µ —Å —É—á–∏—Ç–µ–ª–µ–º: –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –¥–ª—è –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ ¬´–í –æ–¥–∏–Ω –∫–ª–∏–∫¬ª

# 

# –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ ¬´–í –æ–¥–∏–Ω –∫–ª–∏–∫¬ª, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–¥–∞—ë—Ç —Ä–∞–∑–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã: –¥–ª—è –¥–µ—Ç–µ–π, –¥–ª—è –¥–æ–º–∞, –º–µ–ª–∫—É—é –±—ã—Ç–æ–≤—É—é —Ç–µ—Ö–Ω–∏–∫—É, –∫–æ—Å–º–µ—Ç–∏–∫—É –∏ –¥–∞–∂–µ –ø—Ä–æ–¥—É–∫—Ç—ã. 
# 
# 
# <b>–ó–∞–¥–∞—á–∞</b>: —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.
# 
# <b>–¶–µ–ª–∏</b> –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏:
# - –ù—É–∂–Ω–æ –ø—Ä–æ–º–∞—Ä–∫–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π;
# - –ù—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∂–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞;
# - –í –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞: –∫–∞–∫–æ–π –¥–æ—Ö–æ–¥ –∫–∞–∂–¥—ã–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–æ—Å–∏–ª –∫–æ–º–ø–∞–Ω–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞;
# - –ò—Å–ø–æ–ª—å–∑—É—è –¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –Ω—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –Ω–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.
# 
# 
# –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω ¬´–í –æ–¥–∏–Ω –∫–ª–∏–∫¬ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –¥–≤–∞ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞: 
# - –§–∞–π–ª market_file.csv, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç–µ, –æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è—Ö —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º –∏ –µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏. 
# - –§–∞–π–ª market_money.csv, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –≤—ã—Ä—É—á–∫–µ, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—É—á–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è, —Ç–æ –µ—Å—Ç—å —Å–∫–æ–ª—å–∫–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –≤—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–∞–π—Ç–æ–º.
# - –§–∞–π–ª market_time.csv, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏ (–≤ –º–∏–Ω—É—Ç–∞—Ö), –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–æ–≤—ë–ª –Ω–∞ —Å–∞–π—Ç–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞.
# - –§–∞–π–ª money.csv, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞: –∫–∞–∫—É—é –ø—Ä–∏–±—ã–ª—å –ø–æ–ª—É—á–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω –æ—Ç –ø—Ä–æ–¥–∞–∂ –∫–∞–∂–¥–æ–º—É –ø–æ–∫—É–ø–∞—Ç–µ–ª—é.

# <b>–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_file.csv</b> 
# 
# - <b>id</b> ‚Äî –Ω–æ–º–µ—Ä –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö; (0)
# - <b>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</b> ‚Äî —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (—Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫): ¬´—Å–Ω–∏–∑–∏–ª–∞—Å—å¬ª –∏–ª–∏ ¬´–ø—Ä–µ–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å¬ª; (1)
# - <b>–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞</b> ‚Äî —É—Ä–æ–≤–µ–Ω—å —Å–µ—Ä–≤–∏—Å–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä ¬´–ø—Ä–µ–º–∏—É–º¬ª –∏ ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç¬ª; (2)
# - <b>–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–∞—Ç—å</b> ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–∏—Å—ã–ª–∞—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ —Ç–æ–≤–∞—Ä–µ. –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —ç—Ç–æ –¥–∞—ë—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—å; (3)
# - <b>–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å</b> ‚Äî —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –∫–æ–º–ø–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–µ —á–∏—Å–ª–æ —Ä–∞—Å—Å—ã–ª–æ–∫, –∑–≤–æ–Ω–∫–æ–≤, –ø–æ–∫–∞–∑–æ–≤ —Ä–µ–∫–ª–∞–º—ã –∏ –ø—Ä–æ—á–µ–≥–æ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞; (4)
# - <b>–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å</b> ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ; (5)
# - <b>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</b> ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø—Ä–æ—à–ª–æ —Å –º–æ–º–µ–Ω—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç–µ; (6)
# - <b>–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏</b> ‚Äî—Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–∞—è –¥–æ–ª—è –ø–æ–∫—É–ø–æ–∫ –ø–æ –∞–∫—Ü–∏–∏ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–∫—É–ø–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤; (7)
# - <b>–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è</b> ‚Äî  —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —É –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤; (8)
# - <b>–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç</b> ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª –∑–∞ –≤–∏–∑–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞; (9)
# - <b>–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª</b> ‚Äî –æ–±—â–µ–µ —á–∏—Å–ª–æ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞; (10)
# - <b>–û—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞</b> ‚Äî  —á–∏—Å–ª–æ —Å–±–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Å–Ω—É–ª–∏—Å—å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –≤–æ –≤—Ä–µ–º—è –ø–æ—Å–µ—â–µ–Ω–∏—è —Å–∞–π—Ç–∞; (11)
# - <b>–°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç</b> ‚Äî  —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –∑–∞ –æ–¥–∏–Ω –≤–∏–∑–∏—Ç –Ω–∞ —Å–∞–π—Ç –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞. (12)
# 
# –í—Å–µ–≥–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ <b>13 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</b>. 

# <b>–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_money.csv</b> 
# 
# - <b>id</b> ‚Äî –Ω–æ–º–µ—Ä –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö; (0)
# - <b>–ü–µ—Ä–∏–æ–¥</b> ‚Äî  –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞, –≤–æ –≤—Ä–µ–º—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –≤—ã—Ä—É—á–∫–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü' –∏–ª–∏ '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü'; (1)
# - <b>–í—ã—Ä—É—á–∫–∞</b> ‚Äî —Å—É–º–º–∞ –≤—ã—Ä—É—á–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥. (2)
#  
# –í—Å–µ–≥–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ <b>3 –ø—Ä–∏–∑–Ω–∞–∫–∞</b>. 

# <b>–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_time.csv</b> 
# 
# - <b>id</b> ‚Äî –Ω–æ–º–µ—Ä –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö; (0)
# - <b>–ü–µ—Ä–∏–æ–¥</b> ‚Äî  –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞, –≤–æ –≤—Ä–µ–º—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –æ–±—â–µ–µ –≤—Ä–µ–º—è.; (1)
# - <b>–º–∏–Ω—É—Ç</b> ‚Äî  –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏, –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –Ω–∞ —Å–∞–π—Ç–µ, –≤ –º–∏–Ω—É—Ç–∞—Ö.. (2)
#  
# –í—Å–µ–≥–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ <b>3 –ø—Ä–∏–∑–Ω–∞–∫–∞</b>. 

# <b>–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ money.csv</b> 
# 
# - <b>id</b> ‚Äî –Ω–æ–º–µ—Ä –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö; (0)
# - <b>–ü—Ä–∏–±—ã–ª—å</b> ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏. (1)
# 
# –í—Å–µ–≥–æ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ <b>2 –ø—Ä–∏–∑–Ω–∞–∫–∞</b>. 

# In[1]:


# pip install --upgrade jupyterlab


# In[2]:


pip install shap


# In[3]:


pip install phik


# In[4]:


pip install fitter


# In[5]:


pip install -U scikit-learn


# In[6]:


pip install seaborn


# In[7]:


pip install -U numba


# In[8]:


pip install --upgrade pip


# In[9]:


pip install matplotlib==3.5.2


# In[10]:


import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
import shap
import matplotlib.cm

from IPython.display import display
from matplotlib import colors
from matplotlib.ticker import PercentFormatter

from fitter import Fitter, get_common_distributions, get_distributions

#vif
from statsmodels.tools.tools import add_constant
from statsmodels.stats.outliers_influence import variance_inflation_factor 

#preprocessing
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline
from sklearn.utils import shuffle
from sklearn.preprocessing import OneHotEncoder, OrdinalEncoder, StandardScaler, MinMaxScaler, LabelEncoder
from sklearn.impute import SimpleImputer

#models
from sklearn.tree import DecisionTreeClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier, RandomForestRegressor
from sklearn.linear_model import LinearRegression
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC

#metrics
from sklearn.metrics import accuracy_score, f1_score, roc_auc_score, r2_score
from sklearn.model_selection import RandomizedSearchCV, GridSearchCV
from phik.report import plot_correlation_matrix
from phik import phik_matrix
from phik.report import plot_correlation_matrix
from phik import report


warnings.filterwarnings("ignore", category=FutureWarning)


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
# <font color='green'> –•–æ—Ä–æ—à–µ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤! \
# –ò–º–ø–æ—Ä—Ç—ã —Å–æ–±—Ä–∞–Ω—ã –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ, —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π.</font>

# ## –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# In[11]:


market_file = pd.read_csv('/datasets/market_file.csv', sep = ',', decimal='.')
market_money = pd.read_csv('/datasets/market_money.csv', sep = ',', decimal='.')
market_time = pd.read_csv('/datasets/market_time.csv',  sep = ',', decimal='.')
money = pd.read_csv('/datasets/money.csv',  sep = ';', decimal=',')


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# In[12]:


market_file.head(5)


# In[13]:


market_money.head(5)


# In[14]:


market_time.head(5)


# In[15]:


money.head(5)


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
# <font color='green'>–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä –ø—Ä–æ–≤–µ–¥–µ–Ω.</font>

# ### –ò–∑—É—á–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ market_file.csv

# In[16]:


market_file.info()


# In[17]:


market_file.isna().mean()


# In[18]:


market_file.duplicated().sum()


# –ò–∑—É—á–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö Dtype object:

# In[19]:


market_file['–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'].unique()


# In[20]:


market_file['–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞'].unique()


# In[21]:


market_file['–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–∞—Ç—å'].unique()


# In[22]:


market_file['–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è'].unique()


# ### –ò–∑—É—á–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ market_money.csv

# In[23]:


market_money.info()


# In[24]:


market_money.isna().mean()


# In[25]:


market_money.duplicated().sum()


# In[26]:


market_money['–ü–µ—Ä–∏–æ–¥'].unique()


# ### –ò–∑—É—á–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ market_time.csv

# In[27]:


market_time.info()


# In[28]:


market_time.isna().mean()


# In[29]:


market_time.duplicated().sum()


# –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –∏–∑—É—á–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö Dtype object:

# In[30]:


market_time['–ü–µ—Ä–∏–æ–¥'].unique()


# ### –ò–∑—É—á–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ money.csv

# In[31]:


money.info()


# In[32]:


money.isna().mean()


# In[33]:


money.duplicated().sum()


# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 1 –ø—Ä–æ–≤–µ–¥–µ–Ω –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤. 
# –ü—Ä–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–ø–∏—Å–∞–Ω–∏—é. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –¥–∞–Ω–Ω—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –Ø–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –±—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ.

# ## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_file.csv

# In[34]:


market_file = market_file.rename(columns={
    '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
    '–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞': '–¢–∏–ø_—Å–µ—Ä–≤–∏—Å–∞',
    '–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–æ–±—â–∞—Ç—å': '–†–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å'
})


# In[35]:


market_file.loc[market_file['–¢–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'] == '—Å—Ç–∞–Ω–¥–∞—Ä—Ç—Ç', '–¢–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'] = '—Å—Ç–∞–Ω–¥–∞—Ä—Ç'


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_money.csv

# In[36]:


market_money.loc[market_money['–ü–µ—Ä–∏–æ–¥'] == '–ø—Ä–µ–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü', '–ü–µ—Ä–∏–æ–¥'] = '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü'


# In[37]:


market_money = market_money.rename(columns={'–ü–µ—Ä–∏–æ–¥': '–ü–µ—Ä–∏–æ–¥_–¥–µ–Ω—å–≥–∏'})


# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_time.csv¬∂

# In[38]:


market_time['–ü–µ—Ä–∏–æ–¥'] = market_time['–ü–µ—Ä–∏–æ–¥'].str.replace('–ø—Ä–µ–¥—ã–¥—Ü—â–∏–π_–º–µ—Å—è—Ü', '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü')


# In[39]:


market_time = market_time.rename(columns={'–ü–µ—Ä–∏–æ–¥': '–ü–µ—Ä–∏–æ–¥_–≤—Ä–µ–º—è'})


# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 2 –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤. 
# –í —Ö–æ–¥–µ –ø—Ä–µ–¥–æ–±—Ä–∞—Ç–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–ø–µ—á–∞—Ç–∫–∏.
#     
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –¥–ª—è –µ–¥–∏–Ω–æ–±—Ä–∞–∑–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤.    

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚úîÔ∏è\
# <font color='green'>–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä –ø—Ä–æ–≤–µ–¥–µ–Ω.</font>

# ## –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö 

# –û—Ç–±–µ—Ä–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ —Ç—Ä—ë—Ö –º–µ—Å—è—Ü–µ–≤, —Ç–æ –µ—Å—Ç—å —Ç–∞–∫–∏—Ö, –∫–æ—Ç–æ—Ä—ã–µ —á—Ç–æ-–ª–∏–±–æ –ø–æ–∫—É–ø–∞–ª–∏ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥.

# In[40]:


market_file = market_file.set_index('id')
market_money = market_money.set_index('id')
market_time = market_time.set_index('id')
money = money.set_index('id')


# In[41]:


def plot_boxplots(filename):

    numeric_cols = filename.select_dtypes(include=['number']).columns

    num_plots = len(numeric_cols)
    plt.figure(figsize=(10, 5 * num_plots))

    for i, col in enumerate(numeric_cols):

        plt.subplot(num_plots, 2, 2*i + 2)
        filename.boxplot(column=col)
        plt.title(f'–ì—Ä–∞—Ñ–∏–∫ —è—â–∏–∫ —Å —É—Å–∞–º–∏ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ {col}')

    plt.tight_layout()
    plt.show()


# In[42]:


def plot_histograms_1(filename, n_bins):
    numeric_cols = filename.select_dtypes(include=['number']).columns

    num_plots = len(numeric_cols)
    plt.figure(figsize=(10, 5 * num_plots))

    for i, col in enumerate(numeric_cols):
        plt.subplot(num_plots, 2, 2*i + 1)
        filename[col].hist(bins=15)
        plt.title(f'–°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –¥–ª—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ {col}')
        plt.xlabel(col)
        plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
        
    plt.tight_layout()
    plt.show()


# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_file.csv

# #### –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏ boxplot) –¥–ª—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_file.csv

# In[43]:


market_file.describe()


# plot_countplots_1(market_file, 20)

# In[44]:


plot_boxplots(market_file)


# –í —Å—Ç–æ–ª–±—Ü–∞—Ö:
# - –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å;
# - –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏;
# - –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª 
# –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤—ã–±—Ä–æ—Å—ã.

# In[45]:


plot_histograms_1(market_file, 25)


# –ü—Ä–∏–∑–Ω–∞–∫ –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –±–∏–º–æ–¥–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.

# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_money.csv

# #### –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏ boxplot) –¥–ª—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_money.csv

# In[46]:


market_money.describe()


# In[47]:


plot_boxplots(market_money)


# In[48]:


plot_histograms_1(market_money, 15)


# –í —Å—Ç–æ–ª–±—Ü–µ –í—ã—Ä—É—á–∫–∞ —Ç–∞–∫–∂–µ –ø—Ä–∏—Å—É—Ç—Å–≤—É—é—Ç –≤—ã–±—Ä–æ—Å—ã, –∏–∑-–∑–∞ —á–µ–≥–æ —Å—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∞. –õ—É—á—à–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–∏ –≤—ã–±—Ä–æ—Å—ã.

# In[49]:


market_money.sort_values(by='–í—ã—Ä—É—á–∫–∞', ascending=False).head(10)


# –£–¥–∞–ª–∏–º –≤—ã–±—Ä–æ—Å 106862.2:

# In[50]:


market_money = market_money[market_money['–í—ã—Ä—É—á–∫–∞'] != 106862.2]


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —è–≤–Ω—ã–π –≤—ã–±—Ä–æ—Å.
# –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, –∞ –º–æ–∂–Ω–æ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞.</font>

# –ü–µ—Ä–µ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏:

# In[51]:


plot_boxplots(market_money)


# In[52]:


plot_histograms_1(market_money, 50)


# In[53]:


market_money.sort_values(by='–í—ã—Ä—É—á–∫–∞', ascending=True).head(10)


# –£–¥–∞–ª–∏–º –Ω—É–ª–∏:

# In[54]:


market_money = market_money[market_money['–í—ã—Ä—É—á–∫–∞'] != 0]


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'>–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã üëå</font>

# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º market_time.csv

# #### –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏ boxplot) –¥–ª—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ market_time.csv

# In[55]:


market_time.describe()


# In[56]:


plot_boxplots(market_time)


# In[57]:


plot_histograms_1(market_time, 20)


# ### –î–∞—Ç–∞—Ñ—Ä–µ–π–º ¬†money.csv

# –ò–∑ –æ–ø–∏—Å–∞–Ω–∏—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ money.csv —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–¥–∞—Ç–∞—Ñ—Ä–µ–π–º) —Å –∏–æ–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞: –∫–∞–∫—É—é –ø—Ä–∏–±—ã–ª—å –ø–æ–ª—É—á–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω –æ—Ç –ø—Ä–æ–¥–∞–∂ –∫–∞–∂–¥–æ–º—É –ø–æ–∫—É–ø–∞—Ç–µ–ª—é. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π —Ä–∞–≤–Ω—ã—Ö 0, —Ç–æ –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–≤–µ—Ä—à–∞–ª–∏ –ø–æ–∫—É–ø–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω—É–∂–Ω–æ–≥–æ —Å—Ä–æ–∫–∞, –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã–º–∏ –≤ –∫–æ–≥–æ—Ä—Ç—É –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ —Ç—Ä—ë—Ö –º–µ—Å—è—Ü–µ–≤. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –æ—Ç—Å–µ—è—Ç—å —Ç–∞–∫–æ–≤—ã—Ö (–∏–º–µ—é—â–∏–º –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è). –ü—Ä–æ–≤–µ—Ä–∏–º —ç—Ç–æ –Ω–∏–∂–µ.

# In[58]:


money.describe()


# –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ	0.860000, –∑–Ω–∞—á–∏—Ç –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã —á—Ç–æ-–ª–∏–±–æ –ø–æ–∫—É–ø–∞–ª–∏ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥, –∏ –Ω–∏–∫–æ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∞—Ç—å.

# In[59]:


plot_boxplots(money)


# In[60]:


plot_histograms_1(money, 20)


# –í –ø—Ä–∏–∑–Ω–∞–∫–µ –ü—Ä–∏–±—ã–ª—å —Ç–∞–∫–∂–µ –ø—Ä–∏—Å—É—Ç—Å–≤—É—é—Ç –≤—ã–±—Ä–æ—Å—ã.

# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 3 –ø—Ä–æ–≤–µ–¥–µ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö: –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ boxplot –¥–ª—è –≤—Å–µ—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤. 
#     
# –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ money, –±—ã–ª–∏ –æ—Ç–±–µ—Ä–∞–Ω—ã –∫–ª–∏–µ–Ω—Ç—ã —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –Ω–µ –º–µ–Ω–µ–µ —Ç—Ä—ë—Ö –º–µ—Å—è—Ü–µ–≤, —Ç–æ –µ—Å—Ç—å —Ç–∞–∫–∏–µ, –∫–æ—Ç–æ—Ä—ã–µ —á—Ç–æ-–ª–∏–±–æ –ø–æ–∫—É–ø–∞–ª–∏ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥.  

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'>–•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —á–∞—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: –º–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Ñ—É–Ω–∫—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–µ—à—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.</font>

# ## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü 

# ### –û–±—ä–µ–¥–∏–Ω–∏–º —Ç–∞–±–ª–∏—Ü—ã market_file.csv, market_money.csv, market_time.csv.  

# In[61]:


market_money.head(5)


# In[62]:


market_time.head(10)


# In[63]:


df_money_grouped = market_money.groupby(['id', '–ü–µ—Ä–∏–æ–¥_–¥–µ–Ω—å–≥–∏']).agg({'–í—ã—Ä—É—á–∫–∞': 'sum'}).reset_index()


# In[64]:


#df_money_grouped


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ö†Ô∏è\
# <font color='darkorange'>–î–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –ª—É—á—à–µ –≤—Å–µ–≥–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –º–µ—Ç–æ–¥–∞–º–∏ .head(), .tail(), sample(). –ò–Ω–∞—á–µ –≤ –≤—ã–≤–æ–¥–∞—Ö —è—á–µ–π–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤–µ—Å—å –î–∞—Ç–∞—Ñ—Ä–µ–π–º, —Ö–æ—Ç—å –æ–Ω –∏ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é. –¢–∞–∫–∏–µ –ê—É—Ç–ø—É—Ç—ã —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—é—Ç —Ç–µ—Ç—Ä–∞–¥–∫—É.</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –ü—Ä–∏–Ω—è—Ç–æ. –°–ø–∞—Å–∏–±–æ!
# </font>
# </div>

# In[65]:


df_time_grouped = market_time.groupby(['id', '–ü–µ—Ä–∏–æ–¥_–≤—Ä–µ–º—è']).agg({'–º–∏–Ω—É—Ç': 'sum'}).reset_index()


# In[66]:


#df_time_grouped


# In[67]:


df_money_temp = pd.DataFrame(columns=['id', '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—ã—Ä—É—á–∫–∞', '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–≤—ã—Ä—É—á–∫–∞'])


# In[68]:


df_time_temp = pd.DataFrame(columns=['id', '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–º–∏–Ω—É—Ç', '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–º–∏–Ω—É—Ç'])


# In[69]:


df_money_test = pd.pivot_table(df_money_grouped, values = '–í—ã—Ä—É—á–∫–∞', index=['id'], 
                               columns=['–ü–µ—Ä–∏–æ–¥_–¥–µ–Ω—å–≥–∏'], aggfunc="sum")


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
# <font color='red'> ~~–ó–¥–µ—Å—å –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –Ω—É–ª—è–º–∏. –ü—Ä–æ–ø—É—Å–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–∞—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ—Ç–æ—Ä—ã–µ –º—ã —É–¥–∞–ª–∏–ª–∏ –≤ –®–∞–≥–µ –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –≤—ã—Ä—É—á–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ó–∞–ø–æ–ª–Ω—è—è –Ω—É–ª—ë–º –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –≤—Å—ë –≤ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# In[70]:


df_money_test.reset_index()


# In[71]:


df_time_test = pd.pivot_table(df_time_grouped, values = '–º–∏–Ω—É—Ç', index=['id'], 
                               columns=['–ü–µ—Ä–∏–æ–¥_–≤—Ä–µ–º—è'], aggfunc="sum")


# In[72]:


df_time_test


# In[73]:


df_combined = pd.merge(df_money_test, df_time_test, on='id')
df = pd.merge(market_file, df_combined, on='id')


# In[74]:


df.columns


# In[75]:


df = df.rename(columns={'–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_x': '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏'})
df = df.rename(columns={'–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_y': '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è'})
df = df.rename(columns={'—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_x': '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏'})
df = df.rename(columns={'—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_y': '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è'})


# In[76]:


df.shape


# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 4 –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã market_file.csv, market_money.csv –∏ market_time.csv.  –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞ money.csv –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É –æ–Ω–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã.

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
# <font color='red'> ~~–ü–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü, —Ç–∞–±–ª–∏—Ü—ã df_money –∏ df_time –Ω—É–∂–Ω–æ "—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å" –ø–æ id, —á—Ç–æ–±—ã –æ–¥–∏–Ω id –±—ã–ª —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ—á–∫–µ. –í—Å–µ–≥–æ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è 1296 —Å—Ç—Ä–æ–∫ (1297 - –µ—Å–ª–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤—ã–±—Ä–æ—Å).\
# –ú–æ–≥—É—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –º–µ—Ç–æ–¥—ã pivot_table() –∏–ª–∏ groupby().~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –Ω–æ —è —É –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–æ—Å—å 1300. –ù–µ –º–æ–≥—É –ø–æ–Ω—è—Ç—å - –ø–æ—á–µ–º—É.
# </font>
# </div>

# In[77]:


# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ —Å –Ω—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.
df[df[['–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏','—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏']].eq(0).any(axis=1)].shape[0]


# In[78]:


df = df[df['–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏'] != 0]


# In[79]:


df = df[df['—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏'] != 0]


# In[80]:


df = df.dropna()


# In[81]:


df.shape


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
# <font color='red'> ~~–ù—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ –∫–ª–∏–µ–Ω—Ç–∞ —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –≤—ã—Ä—É—á–∫–æ–π.~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# ## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ 

# ### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å

# In[82]:


def fitter_function(row_name):
    for_f = df[row_name].values
    f = Fitter(for_f,
           distributions=['gamma',
                          'lognorm',
                          "beta",
                          "burr",
                          "norm"])
    f.fit()
    return f.summary()


# In[83]:


fitter_function('–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å')


# In[84]:


fitter_function('–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å')


# In[85]:


fitter_function('–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å')


# In[86]:


fitter_function('–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏')


# In[87]:


fitter_function('–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç')


# In[88]:


fitter_function('–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª')


# In[89]:


fitter_function('–û—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞')


# In[90]:


fitter_function('–°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç')


# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Å–ª–µ—É–¥—é—â–∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π: - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–∞—É—Å—Å–∞ - –±–µ—Ç–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ - –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ - –ª–æ–≥–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ - Burr distribution (–Ω–µ –Ω–∞—à–ª–∞ —Ä—É—Å—Å–∫–∏–π —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç). –î—É–º–∞—é, —á—Ç–æ –Ω–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–Ω–∞—á–µ–Ω–∏—è ks_pvalue –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏. –¢–æ–≥–¥–∞: –Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞, —á—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ–≤–ø–∞–¥–∞—é—Ç, –∑–Ω–∞—á–∏—Ç, –ø—Ä–∏ p-value < 0.05 –æ—Ç–∫–ª–æ–Ω—è–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. 
# 
# 
# –í–µ–∑–¥–µ ks_pvalue <0.05, –∑–Ω–∞—á–∏—Ç –Ω–∏–∫–∞–∫–æ–µ –∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –Ω–µ —è–≤–ª—è–µ—Ç—Å—è (—á—Ç–æ, –≤ —Ü–µ–ª–æ–º, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –∏ —Ç–∞–∫ –≤–∏–¥–Ω–æ), –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–ª–µ–µ –°–ø–∏—Ä–º–µ–Ω–∞.

# ### –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ –≤ –∏—Ç–æ–≥–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è

# In[91]:


numeric_cols = df.select_dtypes(include=['number']).columns
correlation_matrix = df[numeric_cols].corr(method='spearman')

plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.show()


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ö†Ô∏è\
# <font color='darkorange'>–•–æ—Ä–æ—à–∏–º —Ä–µ—à–µ–Ω–∏–µ–º –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ $\phi_K$ , —ç—Ç–æ –ø–µ—Ä–µ–¥–æ–≤–æ–π —Å–ø–æ—Å–æ–± –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –ª—é–±—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –µ—Å—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è. –°—Ç–æ–∏—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏, –Ω–æ –∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ. –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –ø–æ–Ω—è—Ç—å –≤–∏–¥ —Å–≤—è–∑–∏ –ø–æ–º–æ–∂–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é –¥–∏–∞–≥—Ä–∞–º–º —Ä–∞—Å—Å–µ—è–Ω–∏—è. –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: https://phik.readthedocs.io/en/latest/
# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:</font>
# ```python
# from phik.report import plot_correlation_matrix
# from phik import report
# 
# # —Å–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# interval_cols = [...]
# 
# # –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ phi –¥–ª—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ df
# phik_overview = df.phik_matrix(interval_cols=interval_cols)
# 
# # –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
# plot_correlation_matrix(
#     phik_overview.values,
#     x_labels=phik_overview.columns,
#     y_labels=phik_overview.index,
#     title=r"correlation $\phi_K$",
#     fontsize_factor=1.5,
#     figsize=(15, 12)
# )
# ```

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –°–ø–∞—Å–∏–±–æ, –ü–∞–≤–µ–ª!
# </font>
# </div>

# ### –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å —Å –ø–æ–º–æ—â—å—é VIF (Variance Inflation Factor)

# In[92]:


numeric_cols = df.select_dtypes(include=['number']).columns
X = add_constant(df[numeric_cols])
pd.Series([variance_inflation_factor(X.values, i) 
               for i in range(X.shape[1])], 
              index=X.columns)


# –î–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏:
# 
# VIF –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω –æ—Ç –µ–¥–∏–Ω–∏—Ü—ã –¥–æ –ø–ª—é—Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø—Ä–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π variance inflation factor –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤:
# 
# - VIF = 1, –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è
# - 1 < VIF <= 5 ‚Äî —É–º–µ—Ä–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è
# - 5 < VIF <= 10 ‚Äî –≤—ã—Å–æ–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è
# - –ë–æ–ª–µ–µ 10 ‚Äî –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è
# 
# https://www.dmitrymakarov.ru/opt/mlr-04/

# –ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –≤ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ –Ω–µ—Ç.

# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 5 –ø—Ä–æ–≤–µ–¥–µ–Ω –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö.
#     
#     
# –ü–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ —É–º–µ—Ä–µ–Ω–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
# - –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6–º–µ—Å –∏ –°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 0.32);
# - –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6–º–µ—Å –∏ –º–∏–Ω—É—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 0.25);
# - –°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç –∏ –º–∏–Ω—É—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 0.37).
#     
#     
#     –¢–∞–∫–∂–µ –±—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –≤ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ –Ω–µ—Ç.
# 

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# ## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ 

# ### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö 

# - –í–æ –≤—Ä–µ–º—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º ColumnTransformer. 
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ —Ä–∞–∑–¥–µ–ª—å–Ω–æ. 
# 
# - –î–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –º–∏–Ω–∏–º—É–º –¥–≤–∞ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞, –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö ‚Äî –∫–∞–∫ –º–∏–Ω–∏–º—É–º –¥–≤–∞ —Å–∫–µ–π–ª–µ—Ä–∞.

# In[93]:


RANDOM_STATE = 42
TEST_SIZE = 0.25


# In[94]:


df.head(5)


# In[95]:


encoder = LabelEncoder()

X = df.drop(['–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'], axis=1)
y = df['–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∞—è_–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å']

X_train, X_test, y_train, y_test = train_test_split(
    X,
    y,
    test_size = TEST_SIZE, 
    random_state = RANDOM_STATE,
    stratify = y)

ohe_columns = ['–†–∞–∑—Ä–µ—à–∏—Ç—å_—Å–æ–æ–±—â–∞—Ç—å', 
            '–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è']

ord_columns = ['–¢–∏–ø_—Å–µ—Ä–≤–∏—Å–∞']

num_columns = [
    '–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6_–º–µ—Å', 
    '–ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_—Ç–µ–∫_–º–µ—Å', 
    '–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
    '–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', 
    '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç',
    '–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', 
    '–û—à–∏–±–∫–∞_—Å–µ—Ä–≤–∏—Å–∞',
    '–°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç', 
    '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏', 
    '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏',
    '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è', 
    '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è']

encoder.fit(y_train)

y_train = encoder.transform(y_train)
y_test = encoder.transform(y_test)


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚ùå\
# <font color='red'> ~~–≠–Ω–∫–æ–¥–µ—Ä –º–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.\
# –¢–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º.~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå ¬†–£–±—Ä–∞–ª–∞ Encoder.
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# In[96]:


ohe_pipe = Pipeline(
    [
        (
            'simpleImputer_ohe', 
            SimpleImputer(missing_values=np.nan, strategy='most_frequent')
        ),
        (
            'ohe', 
            OneHotEncoder(drop='first', sparse_output=False, handle_unknown='ignore')
        )
    ]
) 
print(ohe_pipe)


# In[97]:


df['–¢–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'].unique()


# In[98]:


ord_pipe = Pipeline(
    [
        (
            'simpleImputer_before_ord', 
            SimpleImputer(missing_values=np.nan, strategy='most_frequent')
        ),
        (
            'ord',
            OrdinalEncoder(
                categories=[
                    ['–ø—Ä–µ–º–∏—É–º', '—Å—Ç–∞–Ω–¥–∞—Ä—Ç']
                ], 
                handle_unknown='use_encoded_value',
                unknown_value=np.nan
            )
        ),
        (
            'simpleImputer_after_ord', 
            SimpleImputer(missing_values=np.nan, strategy='most_frequent')
        )
    ]
)


# In[99]:


num_pipe = Pipeline(
    [
        (
            'scaler', 
            StandardScaler(),  MinMaxScaler())
    ]
)
 
print(num_pipe)


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
# <font color='red'> ~~–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ, '–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è' - –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ—Ä—è–¥–∫–æ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º. –û–Ω –Ω–µ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ —Ä–∞–Ω–≥—É –Ω–∏ –ø–æ –∫–∞–∫–æ–º—É —Ñ–∞–∫—Ç–æ—Ä—É.\
# –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å OE (–¥–µ—Ä–µ–≤—å—è), –Ω–æ –¥–ª—è –õ–∏–Ω–µ–π–∫–∏ —ç—Ç–æ –Ω—É–∂–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤ OHE.~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå ¬†–î–æ–±–∞–≤–∏–ª–∞ –ø–æ–ø—É–ª—è—Ä–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ Ohe, –µ—Å–ª–∏ —è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–Ω—è–ª–∞. 
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
# <font color='red'> ~~–ü–æ –∑–∞–¥–∞–Ω–∏—é –Ω—É–∂–Ω–æ –¥–≤–∞ –≠–Ω–∫–æ–¥–µ—Ä–∞.\
# –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –¥–ª—è LR, KNN –∏ SVC - OHE, –∞ –¥–ª—è –î–µ—Ä–µ–≤–∞ OE,\
# a –º–æ–∂–Ω–æ –∑–∞—Å—É–Ω—É—Ç—å –≤ ord_columns –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä '—Ç–∏–ø_—Å–µ—Ä–≤–∏—Å–∞'.~~ </font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –°–¥–µ–ª–∞–ª–∞.
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# ### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–¥–±–æ—Ä–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

# - –û–±—É—á–∏–º —á–µ—Ç—ã—Ä–µ –º–æ–¥–µ–ª–∏: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() –∏  SVC(). 
# 
# - –î–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö –ø–æ–¥–±–µ—Ä–µ–º –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ –ø–æ–¥—Ö–æ–¥—è—â—É—é –¥–ª—è –∑–∞–¥–∞—á–∏ –º–µ—Ç—Ä–∏–∫—É.

# In[100]:


data_preprocessor = ColumnTransformer(
    [
        ('ohe', ohe_pipe, ohe_columns),
        ('ord', OrdinalEncoder(), ord_columns),
        ('num', num_pipe, num_columns)
    ], 
    remainder='passthrough'
)   


# In[101]:


data_preprocessor_2 = ColumnTransformer([
    
    ('ohe', OneHotEncoder(drop='first', handle_unknown='error'), ohe_columns),
    ('ord', ord_pipe, ord_columns),
    ('num', MinMaxScaler(), num_columns)
], 
    remainder='passthrough'
)


# In[102]:


pipe_final = Pipeline(
    [
        ('preprocessor', data_preprocessor),
        ('models', DecisionTreeClassifier(random_state=RANDOM_STATE))
    ]
)


# In[103]:


param_grid = [
    {
        'models': [DecisionTreeClassifier(random_state=RANDOM_STATE)],
        'models__max_depth': range(2, 5),
        'models__max_features': range(2, 5),
        'preprocessor': [data_preprocessor, data_preprocessor_2]

    },
    {
        'models': [KNeighborsClassifier()],
        'models__n_neighbors': range(5, 100),
        'preprocessor': [data_preprocessor, data_preprocessor_2]
    },

    {
        'models': [LogisticRegression(random_state=RANDOM_STATE)],
        'models__C': [0.1, 1.0, 10.0, 100.0],
         'preprocessor': [data_preprocessor, data_preprocessor_2]
    },
    {
        'models': [SVC(probability=True, random_state=RANDOM_STATE)],
        'models__kernel': ['linear', 'rbf'],
        'preprocessor': [data_preprocessor, data_preprocessor_2]
    }
]


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚ùå\
# <font color='red'> ~~–ü–æ –∑–∞–¥–∞–Ω–∏—é –Ω—É–∂–Ω–æ –¥–≤–∞ –°–∫–∞–ª–µ—Ä–∞.\
# –ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–±–æ—Ä —Å–∫–∞–ª–µ—Ä–æ–≤ –≤ 'preprocessor__num'. ~~</font>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
# <font color='red'> ~~–í SVC, —Ç–æ–∂–µ, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å random_state.~~</font>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# In[104]:


randomized_search = RandomizedSearchCV(
    pipe_final, 
    param_grid, 
    cv=5,
    scoring='roc_auc',
    random_state=RANDOM_STATE,
    n_jobs=-1
)


# In[105]:


get_ipython().run_cell_magic('time', '', "randomized_search.fit(X_train, y_train)\nprint('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\\n\\n', randomized_search.best_estimator_)\nprint ('–ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', randomized_search.best_score_)")


# In[106]:


y_test_pred = randomized_search.predict(X_test)


# In[107]:


print('–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –∏ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n\n', randomized_search.best_estimator_)
print ('–ú–µ—Ç—Ä–∏–∫–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ:', randomized_search.best_score_)


# In[108]:


best_model = randomized_search.best_estimator_
predictions = best_model.predict_proba(X)[:, 1]


# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 6 –æ–±—É—á–µ–Ω—ã —á–µ—Ç—ã—Ä–µ –º–æ–¥–µ–ª–∏: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() –∏ SVC(). –° –ø–æ–º–æ—â—å—é –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –±—ã–ª–∏ –ø–µ—Ä–µ–±—Ä–∞–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –º–æ–¥–µ–ª–∏ –∏ –∏—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é. –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å LogisticRegression(C=0.1, random_state=42).

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
# <font color='red'> ~~–ù—É–∂–Ω–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏.~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå ¬†ROC AUC –º–µ—Ç—Ä–∏–∫–∞ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–æ–¥–µ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –∑–∞–¥–∞—á–∞—Ö –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ—Ä–æ–≥—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–ª–∏ –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É True Positive Rate –∏ False Positive. Rate.
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
# <font color='red'> ~~–ù—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å  ROC-AUC –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.~~</font>

# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'>üëå –ü–æ—Å—á–∏—Ç–∞–Ω–æ –Ω–∏–∂–µ.
# </font>
# </div>

# In[109]:


y_test.shape


# In[110]:


y_test_pred.shape


# In[111]:


print(f'–ú–µ—Ç—Ä–∏–∫–∞ ROC-AUC –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: {round(roc_auc_score(y_test, y_test_pred),3)}')


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚ùå\
# <font color='blue'>roc_auc –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º –∫–ª–∞—Å—Å–æ–≤
# ```python
# probabilities = model.predict_proba(features)
# probabilities_one = probabilities[:, 1]
# print('–ü–ª–æ—â–∞–¥—å ROC-–∫—Ä–∏–≤–æ–π:', roc_auc_score(target, probabilities_one)
# ```
# –°–∞–º–æ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏, —á—Ç–æ —è –≤–∏–¥–µ–ª –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–¥–µ—Å—å: https://alexanderdyakonov.wordpress.com/2017/07/28/auc-roc-–ø–ª–æ—â–∞–¥—å-–ø–æ–¥-–∫—Ä–∏–≤–æ–π-–æ—à–∏–±–æ–∫ \
# –ê –≤–Ω—É—Ç—Ä–∏ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º—ã –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ–º –º–µ—Ç—Ä–∏–∫—É ROC_AUC –∏ —Ç–∞–º –Ω–∏–∫–∞–∫–∏—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ. –¢–∞–∫ –∫–∞–∫ —ç—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ –Ω–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞ –Ω–∞ –≤—Å–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ (–∫–∞–∂–µ—Ç—Å—è, —Ä–∞–∑—Ä—ã–≤ –≤ –Ω—É–ª–µ), —Ç–æ —Ç–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ö–∏—Ç—Ä–æ –º–µ–Ω—è—é—Ç –µ–µ –Ω–∞ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç Gini, —Ç–∞–∫ –∫–∞–∫ Gini = 2 √óAUC_ROC ‚Äì 1 (–º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ)
# </font>

# ## –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

# ### –û—Ü–µ–Ω–∏–º –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ SHAP

# In[112]:


shap.plots.initjs() 
best_model = randomized_search.best_estimator_.named_steps['models']
preprocessor = randomized_search.best_estimator_.named_steps['preprocessor']
X_train_preprocessed = preprocessor.transform(X_train)
X_test_preprocessed = preprocessor.transform(X_test)


# In[113]:


preprocessor.fit(df)


# In[114]:


ohe_feature_names = preprocessor.named_transformers_['ohe'].get_feature_names_out(input_features=ohe_columns)

num_feature_names = num_columns

ord_feature_names = ord_columns

all_feature_names = np.concatenate([ohe_feature_names, num_feature_names, ord_feature_names])


# In[115]:


X_train_preprocessed.shape


# In[116]:


X_train_preprocessed_df = pd.DataFrame(X_train_preprocessed, columns=all_feature_names)
X_test_preprocessed_df = pd.DataFrame(X_test_preprocessed, columns=all_feature_names)


# In[117]:


COUNT=20

X_train_preprocessed_shap = shap.sample(X_train_preprocessed_df, 
                                        COUNT, 
                                        random_state=RANDOM_STATE)

X_test_preprocessed_shap = shap.sample(X_test_preprocessed_df, 
                                       COUNT, 
                                       random_state=RANDOM_STATE)


# In[118]:


best_model = randomized_search.best_estimator_.named_steps['models']
preprocessor = randomized_search.best_estimator_.named_steps['preprocessor']


# In[119]:


explainer = shap.KernelExplainer(best_model.predict_proba, X_train_preprocessed_shap)
shap_values = explainer(X_test_preprocessed_shap)


# In[120]:


shap_values[:, :, 1].shape


# In[121]:


plt.title('Feature Importance Bar', fontsize=14)
plt.ylabel('–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤', fontsize=14)

shap.summary_plot(shap_values[:, :, 1], X_test_preprocessed, 
                  feature_names=all_feature_names, 
                  plot_type='bar')


# In[122]:


shap.summary_plot(shap_values[:, :, 1], X_test_preprocessed_shap)


# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> –í —Ä–∞–∑–¥–µ–ª–µ 7 –ø—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –°–¥–µ–ª–∞–µ–º –≤—ã–≤–æ–¥—ã –æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
# - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è_–∫—É—Ö–æ–Ω–Ω–∞—è_–ø–æ—Å—É–¥–∞ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π_–ú–µ—Å—è—Ü_–≤—Ä–µ–º—è - –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–∞–ª–æ –∑–Ω–∞—á–∏–º—ã –¥–ª—è –º–æ–¥–µ–ª–∏;
# - –°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç, –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ü—Ä–æ–¥—É–∫—Ç—ã, —Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è - –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –≤–ª–∏—è—é—Ç –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫;
# 
#     
#    SHAP –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Ä–µ—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏, —Ç–∞–∫ —á—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–π.

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
# <font color='red'> ~~–ü–æ—Å–∫–æ–ª—å–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ predict_proba, shap_values –∏–º–µ–µ—Ç –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞. –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ –Ω—É–∂–µ–Ω —Å—Ä–µ–∑ –º–∞—Å—Å–∏–≤–∞ –ø–æ —Ü–µ–ª–µ–≤–æ–º—É –∫–ª–∞—Å—Å—É (1).~~</font>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# ## –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π
# 

# ### –í—ã–ø–æ–ª–Ω–∏–º —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.

# In[123]:


threshold_probability = 0.7


# In[124]:


threshold_profit = 3


# In[125]:


df['–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è'] = predictions


# In[126]:


df_seg = df


# In[127]:


df_seg = df.join(money, on='id')


# In[128]:


df_merge = df.join(money, on='id')


# In[129]:


df_seg.info()


# In[130]:


df_seg_2 = df.join(money, on='id')


# In[131]:


prediction_indicate_1 = np.where(df_seg['–ü—Ä–∏–±—ã–ª—å'] > threshold_profit, 
                               True, False)


# In[132]:


df_seg = df_seg.loc[prediction_indicate_1]


# In[133]:


df_seg.head()


# In[134]:


prediction_indicate_2 = np.where(df_seg['–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è'] > threshold_probability, 
                               True, False)


# In[135]:


df_seg = df_seg.loc[prediction_indicate_2]


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# In[136]:


#plt.scatter(predictions, money['–ü—Ä–∏–±—ã–ª—å'], c=prediction_indicate, cmap='coolwarm') 
#plt.plot(7*[threshold], np.arange(1,8), c = 'green', alpha=1)
#plt.title('–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π')
#plt.show()


# In[137]:


plt.figure(figsize=(12,6))
sns.scatterplot(data=df_merge, x='–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è', y='–ü—Ä–∏–±—ã–ª—å', label='–î—Ä—É–≥–∏–µ —Å–µ–≥–º–µ–Ω—Ç—ã', color='purple')
sns.scatterplot(data=df_seg, x='–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è', y='–ü—Ä–∏–±—ã–ª—å', label='–ò—Å—Å–ª–µ–¥—É–µ–º—ã–π —Å–µ–≥–º–µ–Ω—Ç', color='blue')
plt.legend()
plt.axvline(x=threshold_probability, color='green', linestyle = '--')
plt.axhline(y=threshold_profit, color='green', linestyle = '--')
plt.show()

<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2: </b></font> ‚ùå\
<font color='red'> –ù—É–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç –ø–æ –¥–≤—É–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –∏ –ø—Ä–∏–±—ã–ª—å), –¥–ª—è —ç—Ç–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä—É–µ–º –¥–≤–∞ –ø–æ—Ä–æ–≥–∞ –ø–æ —ç—Ç–∏–º –æ—Å—è–º, –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ —ç—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏–µ.
![](https://i.postimg.cc/DZ3GSqwK/102458.png)
–≠—Ç–æ, —É—Å–ª–æ–≤–Ω–æ, —Ç–µ —Å –∫–µ–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Ä–∞–±–æ—Ç–∞—Ç—å.\
–ó–∞—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≥—Ä—É–ø–ø—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ –∞–∫—Ü–∏–æ–Ω–Ω—ã–º –ø–æ–∫—É–ø–∫–∞–º) –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —ç—Ç–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–æ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—å–Ω—ã–º–∏–º –ø–æ –¥—Ä—É–≥–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º, –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–∏–π (–º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–ª–∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã). –ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.</font>
# <div class="alert alert-block alert-info">
# <b>üîÑ–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> 
# <font color='DarkGreen'> ? –¢—É—Ç –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ –ø–æ–ª—É—á–∏–ª–æ—Å—å. –ù–µ –ø–æ–Ω–∏–º–∞—é - –ø–æ—á–µ–º—É.
# </font>
# </div>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> \
# <font color='blue'> –ó–¥–µ—Å—å —Ç–æ—á–∫–∏ –ø–æ–ª–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∑–∞–∫—Ä—ã–≤–∞—é—Ç —Å–µ–≥–º–µ–Ω—Ç. –ß—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ —Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞, –Ω—É–∂–Ω–æ —Å–µ–≥–º–µ–Ω—Ç —Ä–∏—Å–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–º.\
# –ù–û –ª—É—á—à–µ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –Ω–µ —Å –ø–æ–ª–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π, –∞ —Ç–æ–ª—å–∫–æ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–æ—à–ª–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç.</font>
# ```python
# others = df_merge[~df_merge.index.isin(df_seg.index)]
# ```

# ### –í—ã–±–µ—Ä–µ–º –≥—Ä—É–ø–ø—É –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–µ–¥–ª–æ–∂–∏–º, –∫–∞–∫ —É–≤–µ–ª–∏—á–∏—Ç—å –µ—ë –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
<font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚ùå

```python
8.1 –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π.
```
<font color='red'> –ü–æ–ø—Ä–æ–±—É—é –æ–ø–∏—Å–∞—Ç—å, —á—Ç–æ –º—ã –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å:

–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ ‚àí –º—ã –¥–æ–ª–∂–Ω—ã –ø–æ –∑–∞–¥–∞–Ω–∏—é –≤—ã–±—Ä–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–π —Å–µ–≥–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞, –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å —Ç–æ, –∫–∞–∫ –º—ã —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ–º (–ø–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞–µ–º —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –æ—Ç–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–µ–≥–º–µ–Ω—Ç), –∞ –¥–∞–ª—å—à–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç.

–ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ —Å–µ–≥–º–µ–Ω—Ç–∞ –Ω—É–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –¥–≤–µ —à–∫–∞–ª—ã:
- –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è, –ø—Ä–µ–¥–∏–∫—Ç—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã–µ –º–µ—Ç–æ–¥–æ–º predict_proba() –ø–æ –∏—Ç–µ—Ä–µ—Å—É—é—â–µ–º—É –Ω–∞—Å –∫–ª–∞—Å—Å—É ("–°–Ω–∏–∑–∏–ª–æ—Å—å"), –∏
- –ü—Ä–∏–±—ã–ª—å –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã money.csv
    
–ì—Ä–∞–Ω–∏—Ü—ã —Å–µ–≥–º–µ–Ω—Ç–∞ –ø–æ —ç—Ç–∏–º –¥–≤—É–º —à–∫–∞–ª–∞–º –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ –¥–∏–∞–≥—Ä–∞–º–º–µ —Ä–∞—Å—Å–µ—è–Ω–∏—è, –≥–¥–µ –ø–æ –æ–¥–Ω–æ–π –æ—Å–∏ –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è), –∞ –ø–æ –¥—Ä—É–≥–æ–π –ø—Ä–∏–±—ã–ª—å.
    
–î–∞–ª–µ–µ –ø—Ä–æ–≤–æ–¥–∏–º –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—ã–±—Ä–∞–Ω–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—É –∏ –∫–∞–∫–æ–π –Ω–∏–±—É–¥—å –≥—Ä—É–ø–ø—ã –∫–ª–∏–µ–Ω—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–µ—â–∞—é—Ç –º–∞–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü.\
–§–æ—Ä–º—É–ª–∏—Ä—É–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ —Ä–∞–±–æ—Ç–µ —Å —Å–µ–≥–º–µ–Ω—Ç–æ–º –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.</font>
# –í —Ä–∞–∑–¥–µ–ª–µ 7 –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã C—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç, –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª, –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏, –ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è, —Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏ - –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –≤–ª–∏—è—é—Ç –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –∑–¥–µ—Å—å. –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏.

# In[138]:


def plot_top_features_1(n_bins, y, range_left, range_right, ylabel, xlabel, title):
    fig, axs = plt.subplots(1, 2, tight_layout=True)

    N, bins, patches = axs[0].hist(df_seg[y], bins=n_bins, range= (range_left,range_right))

    fracs = N / N.max()

    norm = colors.Normalize(fracs.min(), fracs.max())

    for thisfrac, thispatch in zip(fracs, patches):
        color = plt.cm.viridis(norm(thisfrac))
        thispatch.set_facecolor(color)

    axs[1].hist(df_seg[y], bins=n_bins, density=True, range= (range_left,range_right))

    axs[1].yaxis.set_major_formatter(PercentFormatter(xmax=1))
    plt.ylabel(ylabel)
    plt.xlabel(xlabel)
    plt.title(title)
    return plt


# In[139]:


def plot_top_features_2(n_bins, y, range_left, range_right, ylabel, xlabel, title):
    fig, axs = plt.subplots(1, 2, tight_layout=True)

    N, bins, patches = axs[0].hist(df_merge[y], bins=n_bins, range= (range_left,range_right))

    fracs = N / N.max()

    norm = colors.Normalize(fracs.min(), fracs.max())

    for thisfrac, thispatch in zip(fracs, patches):
        color = plt.cm.viridis(norm(thisfrac))
        thispatch.set_facecolor(color)

    axs[1].hist(df_merge[y], bins=n_bins, density=True, range= (range_left,range_right))

    axs[1].yaxis.set_major_formatter(PercentFormatter(xmax=1))
    plt.ylabel(ylabel)
    plt.xlabel(xlabel)
    plt.title(title)
    return plt


# In[140]:


df_seg.shape


# In[141]:


df_merge.shape


# #### –°—Ä–∞–≤–Ω–∏–º –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_seg –∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_merge

# In[142]:


df_seg['–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏'].describe()


# In[143]:


plot_top_features_1(15, '–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', 0.000000, 0.990000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏')
plt.show()


# In[144]:


df_merge['–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏'].describe()


# In[145]:


plot_top_features_2(15, '–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏', 0.000000, 0.990000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏')
plt.show()


# –î–æ–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–∞ –≤ –ê–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–∫—É–ø–∫–∞—Ö, –ø–æ—ç—Ç–æ–º—É, –≤–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –¥–µ–ª–∞—Ç—å –±–æ–ª—å—à–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∞–∫—Ü–∏–π –¥–ª—è –Ω–∏—Ö.

# #### –°—Ä–∞–≤–Ω–∏–º –°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_seg –∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_merge

# In[146]:


df_seg['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç'].describe()


# In[147]:


plot_top_features_1(15, '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç', 1.000000, 6.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç')
plt.show()


# In[148]:


df_merge['–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç'].describe()


# In[149]:


plot_top_features_2(15, '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç', 1.000000, 6.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç')
plt.show()


# –î–æ–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–∞ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç, –≤ —Å—Ä–µ–¥–Ω–µ–º, –º–µ–Ω—å—à–µ —Å—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –æ–¥–∏–Ω –≤–∏–∑–∏—Ç.

# #### –°—Ä–∞–≤–Ω–∏–º –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_seg –∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_merge

# In[150]:


df_seg['–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª'].describe()


# In[151]:


plot_top_features_1(25, '–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', 0.000000, 10.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª')
plt.show()


# In[152]:


df_merge['–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª'].describe()


# In[153]:


plot_top_features_2(25, '–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª', 0.000000, 10.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ø—Ä–æ–¥—É–∫—Ç—ã_—à—Ç—É–∫_–∫–≤–∞—Ä—Ç–∞–ª')
plt.show()


# –î–æ–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∑–∞ –∫–≤–∞—Ä—Ç–∞–ª, –≤–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É.

# #### –°—Ä–∞–≤–Ω–∏–º —Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_seg –∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_merge

# In[154]:


df_seg['—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è'].describe()


# In[155]:


plot_top_features_1(25, '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è', 4.000000, 17.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è')
plt.show()


# In[156]:


df_merge['—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è'].describe()


# In[157]:


plot_top_features_2(25, '—Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è', 4.000000, 23.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è')
plt.show()


# #### –°—Ä–∞–≤–Ω–∏–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_seg –∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ df_merge

# In[158]:


df_seg['–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏'].describe()


# In[159]:


plot_top_features_1(25, '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏', 7370.000000, 11634.000000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏')
plt.show()


# In[160]:


df_merge['–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏'].describe()


# In[161]:


plot_top_features_2(25, '–ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏', 7103.000000, 12209.500000,  '–ö–æ–ª-–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π',
             '–î–æ–ª—è', '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π_–º–µ—Å—è—Ü_–¥–µ–Ω—å–≥–∏')
plt.show()


# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞: </b></font> ‚ùå\
#  <font color='red'>~~–ù—É–∂–µ–Ω –≤—ã–≤–æ–¥ –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –°–µ–≥–º–µ–Ω—Ç–∞.~~</font>

# <font color='DarkBlue'><b>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥:</b></font><br>
# 
# <font color='DarkGreen'> —Ä–æ–≤–µ–¥–µ–Ω–æ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç–æ–∏—Ç –∞–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏) –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö, –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ç–æ—Ä—ã—Ö —É–¥–µ–ª—è–µ—Ç—Å—è –æ–∫–æ–ª–æ 10 –º–∏–Ω—É—Ç, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –∑–∞ –≤–∏–∑–∏—Ç –æ–∫–æ–ª–æ 5 —Å—Ç—Ä–∞–Ω–∏—Ü.<font color='red'>

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3: </b></font> ‚úîÔ∏è\
# <font color='green'> üëç</font>

# –§–∏–Ω–∞–ª—å–Ω—ã–π –í—ã–≤–æ–¥:
# 
# –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∏—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –±—ã–ª–∏ —Ä–µ—à–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:
# 
# 
# 1) –ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∂–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞.
# 2) –í –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ –æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞: –∫–∞–∫–æ–π –¥–æ—Ö–æ–¥ –∫–∞–∂–¥—ã–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–æ—Å–∏–ª –∫–æ–º–ø–∞–Ω–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∏ –º–µ—Å—è—Ü–∞.
# 3) –ò—Å–ø–æ–ª—å–∑—É—è –¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –≤—ã–¥–µ–ª–µ–Ω—ã —Å–µ–≥–º–µ–Ω—Ç—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–ª—è –Ω–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.
# 
# 
# 
#     –î–ª—è —ç—Ç–æ–≥–æ –±—ã–ª–∏ –ø—Ä–æ–¥–µ–ª–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
#     
# 1) –í —Ä–∞–∑–¥–µ–ª–µ 1 –ø—Ä–æ–≤–µ–¥–µ–Ω –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤.
# 
# 2) –í —Ä–∞–∑–¥–µ–ª–µ 2 –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–æ–≤: —Ö–æ–¥–µ –ø—Ä–µ–¥–æ–±—Ä–∞—Ç–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–ø–µ—á–∞—Ç–∫–∏. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –¥–ª—è –µ–¥–∏–Ω–æ–±—Ä–∞–∑–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤..
# 
# 3) –í —Ä–∞–∑–¥–µ–ª–µ 3 –ø—Ä–æ–≤–µ–¥–µ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, –∏ –∏–º–µ–Ω–Ω–æ: –±—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ (—Ä–∞—Å–ø—Ä–µ–¥–µ–Ω–∏—è –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞–∑–º–∞—Ö–∞ –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤).
#     
# 
# 4) –í —Ä–∞–∑–¥–µ–ª–µ 4 –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏–Ω–µ–∏–µ —Ç–∞–±–ª–∏—Ü—ã market_file.csv, market_money.csv, market_time.csv. –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–∏–±—ã–ª–∏ –∏–∑ —Ñ–∞–π–ª–∞ money.csv –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤–∞–º –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å. 
# 
# 5) –í —Ä–∞–∑–¥–µ–ª–µ 5 –ø—Ä–æ–≤–µ–¥–µ–Ω –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ –≤ –∏—Ç–æ–≥–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è. 
#     
#     –ü–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ —É–º–µ—Ä–µ–Ω–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
# 
# - –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6–º–µ—Å –∏ –°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 0.32);
# - –ú–∞—Ä–∫–µ—Ç_–∞–∫—Ç–∏–≤_6–º–µ—Å –∏ –º–∏–Ω—É—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 0.25);
# - –°—Ç—Ä–∞–Ω–∏—Ü_–∑–∞_–≤–∏–∑–∏—Ç –∏ –º–∏–Ω—É—Ç (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 0.37);
# 
# –¢–∞–∫–∂–µ –±—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –≤ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ –Ω–µ—Ç.
# 
# 6) –í —Ä–∞–∑–¥–µ–ª–µ 6 –æ–±—É—á–µ–Ω—ã —á–µ—Ç—ã—Ä–µ –º–æ–¥–µ–ª–∏: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() –∏  SVC(). –í—ã–±–µ—Ä–∞–Ω–∞ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–¥–∞–Ω–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏ -  LogisticRegression(C=0.1, random_state=42).
# 
# 7)  –í —Ä–∞–∑–¥–µ–ª–µ 7 –ø—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –°–¥–µ–ª–∞–µ–º –≤—ã–≤–æ–¥—ã –æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
# - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è_–∫—É—Ö–æ–Ω–Ω–∞—è_–ø–æ—Å—É–¥–∞ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π_–ú–µ—Å—è—Ü_–≤—Ä–µ–º—è - –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–∞–ª–æ –∑–Ω–∞—á–∏–º—ã –¥–ª—è –º–æ–¥–µ–ª–∏;
# - –°—Ä–µ–¥–Ω–∏–π_–ø—Ä–æ—Å–º–æ—Ç—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏–π_–∑–∞_–≤–∏–∑–∏—Ç, –ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ_–ü—Ä–æ–¥—É–∫—Ç—ã, —Ç–µ–∫—É—â–∏–π_–º–µ—Å—è—Ü_–≤—Ä–µ–º—è - –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –≤–ª–∏—è—é—Ç –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫;
#     
#    SHAP –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Ä–µ—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏, —Ç–∞–∫ —á—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–π.
# 
# 8) –í —Ä–∞–∑–¥–µ–ª–µ 8 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç–æ–∏—Ç –∞–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –∞–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–ê–∫—Ü–∏–æ–Ω–Ω—ã–µ_–ø–æ–∫—É–ø–∫–∏) –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö, –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ç–æ—Ä—ã—Ö —É–¥–µ–ª—è–µ—Ç—Å—è –æ–∫–æ–ª–æ 10 –º–∏–Ω—É—Ç, –∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –∑–∞ –≤–∏–∑–∏—Ç –æ–∫–æ–ª–æ 5 —Å—Ç—Ä–∞–Ω–∏—Ü.

# <font color='blue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ : </b></font> ‚úîÔ∏è\
# <font color='green'> –û—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ –≤–∏–¥–µ—Ç—å –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞!\
# –ü—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≥–ª–∞–≤–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–µ–∫—Ç–∞.</font>

# <font color='blue'><b>–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>\
# <font color='green'>–ú–∞—Ä–∏—è, —Ö–æ—Ä–æ—à–∏–π –ø—Ä–æ–µ–∫—Ç –ø–æ–ª—É—á–∏–ª—Å—è!
# –ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É. –í–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–æ –º–Ω–æ–≥–æ —É—Å–∏–ª–∏–π.
# –í—ã–≤–æ–¥—ã –∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –ø–æ–ª—É—á–∏–ª–∏—Å—å —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω—ã–º–∏, –∏—Ö –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —á–∏—Ç–∞—Ç—å.
# </font>
# 
# <font color='steelblue'>–ù–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –µ—â—ë —Å—Ç–æ–∏—Ç –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å - –µ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—é –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–≤–æ–∏—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞. –¢–∞–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —è –æ—Ç–º–µ—Ç–∏–ª –∂—ë–ª—Ç—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏. –ë—É–¥–µ—Ç –∑–¥–æ—Ä–æ–≤–æ, –µ—Å–ª–∏ —Ç—ã —É—á—Ç—ë—à—å –∏—Ö - —Ç–∞–∫ –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞–Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–º.
# 
# –¢–∞–∫–∂–µ –≤ —Ä–∞–±–æ—Ç–µ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è. –ö —ç—Ç–∏–º –∑–∞–º–µ—á–∞–Ω–∏—è–º —è –æ—Å—Ç–∞–≤–∏–ª –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ—á–∏—Å–ª–∏–ª –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. –£–≤–µ—Ä–µ–Ω, —Ç—ã –±—ã—Å—Ç—Ä–æ —Å —ç—Ç–∏–º —É–ø—Ä–∞–≤–∏—à—å—Å—è:)
# 
# –ï—Å–ª–∏ –æ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –±—É–¥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã - –æ—Å—Ç–∞–≤—å –∏—Ö, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –∏ —è –æ—Ç–≤–µ—á—É –Ω–∞ –Ω–∏—Ö –≤–æ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–≤—å—é.
# 
# –¢–∞–∫–∂–µ –±—É–¥—É —Ä–∞–¥ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ —Ç–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–µ–∫—Ç—É –∏–ª–∏ –Ω–∞ –∫–∞–∫–∏–µ-–ª–∏–±–æ –¥—Ä—É–≥–∏–µ, –µ—Å–ª–∏ –æ–Ω–∏ —É —Ç–µ–±—è –∏–º–µ—é—Ç—Å—è - –æ—Å—Ç–∞–≤—å –∏—Ö –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å:)</font>
# 
# <font color='blue'><b>–ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ä–µ–≤—å—é. –î–æ –≤—Å—Ç—Ä–µ—á–∏ :) </b></font>

# <font color='blue'><b>–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>\
# <font color='green'>–ú–∞—Ä–∏—è, –±–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –¥–æ—Ä–∞–±–æ—Ç—É.
# </font>
# 
# <font color='steelblue'>–ù–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –µ—â—ë —Å—Ç–æ–∏—Ç –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å - –µ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—é –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–≤–æ–∏—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞. –¢–∞–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —è –æ—Ç–º–µ—Ç–∏–ª –∂—ë–ª—Ç—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏. –ë—É–¥–µ—Ç –∑–¥–æ—Ä–æ–≤–æ, –µ—Å–ª–∏ —Ç—ã —É—á—Ç—ë—à—å –∏—Ö - —Ç–∞–∫ –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞–Ω–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–º.
# 
# –¢–∞–∫–∂–µ –≤ —Ä–∞–±–æ—Ç–µ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è. –ö —ç—Ç–∏–º –∑–∞–º–µ—á–∞–Ω–∏—è–º —è –æ—Å—Ç–∞–≤–∏–ª –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫—Ä–∞—Å–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–µ—Ä–µ—á–∏—Å–ª–∏–ª –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. –£–≤–µ—Ä–µ–Ω, —Ç—ã –±—ã—Å—Ç—Ä–æ —Å —ç—Ç–∏–º —É–ø—Ä–∞–≤–∏—à—å—Å—è:)
# 
# –ï—Å–ª–∏ –æ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –±—É–¥—É—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã - –æ—Å—Ç–∞–≤—å –∏—Ö, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –∏ —è –æ—Ç–≤–µ—á—É –Ω–∞ –Ω–∏—Ö –≤–æ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–≤—å—é.
# 
# –¢–∞–∫–∂–µ –±—É–¥—É —Ä–∞–¥ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ —Ç–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–µ–∫—Ç—É –∏–ª–∏ –Ω–∞ –∫–∞–∫–∏–µ-–ª–∏–±–æ –¥—Ä—É–≥–∏–µ, –µ—Å–ª–∏ –æ–Ω–∏ —É —Ç–µ–±—è –∏–º–µ—é—Ç—Å—è - –æ—Å—Ç–∞–≤—å –∏—Ö –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –∏ —è –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å:)</font>
# 
# <font color='blue'><b>–ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ä–µ–≤—å—é. –î–æ –≤—Å—Ç—Ä–µ—á–∏ :) </b></font>

# <font color='blue'><b>–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 3</b></font>\
# <font color='green'> –ú–∞—Ä–∏—è, –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω—è—Ç! \
# –í—Å–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–π–¥–µ–Ω—ã. –í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —É—á—Ç–µ–Ω—ã.\
# –ù–∞–¥–µ—é—Å—å, —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</font> \
# <font color='blue'><b>–°–ø–∞—Å–∏–±–æ, —É–¥–∞—á–∏ –≤ –æ—Å–≤–æ–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏!</b></font>
